<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Processor</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <title>Result</title>
    <style>
        #topic {
        padding: 20px;
        font-family: Arial, sans-serif;
    }

    h1 {
        text-align: center;
        color: #333;
    }

    .topics-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
    }

    .topic-card {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        padding: 15px;
        width: 300px;
        transition: transform 0.2s;
    }

    .topic-card:hover {
        transform: scale(1.05);
    }

    .topic-header {
        font-size: 1.2em;
        font-weight: bold;
        color: #007BFF;
        margin-bottom: 10px;
    }

    .topic-words-list {
        list-style-type: none;
        padding: 0;
    }

    .topic-word {
        font-size: 1em;
        margin: 5px 0;
    }

    .word-weight {
        font-size: 0.9em;
        color: #666;
    }
        body {
            margin-left: 10%;
            margin-right: 10%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            height: 600px;
        }
        .container, .text-container, .conta {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin-top: 20px; /* Adjust margin-top as needed */
        }
        .dataframe-container, .dataframe-container1, .text-box {
            margin: 10px;
            padding: 10px;
            text-align: center;
            max-width: 100%; /* Adjust width as needed */
            border-collapse: collapse; /* Collapse borders */
            max-height: 100%; /* Set max height for the scrollable area */
            overflow-y: auto; /* Enable vertical scrolling */
            border: 1px solid #ccc; /* Optional: Add border for visibility */
            border-radius: 5px; /* Optional: Add border radius for styling */
        }
        .text-box {
            height: 100%; /* Set height to 400px */
        }
        .center {
            text-align: center;
        }
        .dataframe {
            border-collapse: collapse;
            width: 100%;
        }
        .hide {
            display: none;
        }
        .highlight {
            background-color: yellow;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            font-size: 17px;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tab button.active {
            background-color: #ccc;
        }
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
            overflow-y: auto;
        }
        input[type="text"] {
            width: 90%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        input[type="text"]:focus {
            border-color: #4A90E2;
        }

        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: black;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #45a049;
        }
        .myDataFrameStyle {
            width: 100%; /* Sets the table to take the full width of its container */
            border-collapse: collapse; /* Collapses the border lines between cells */
            background-color: #f8f9fa; /* Light grey background for the table */
            margin-top: 20px; /* Adds some space above the table */
        }

        .myDataFrameStyle th, .myDataFrameStyle td {
            border: 1px solid #dee2e6; /* Adds a subtle border to the table cells and headers */
            padding: 8px; /* Adds padding inside the cells for text alignment */
            text-align: left; /* Aligns text to the left */
        }

        .myDataFrameStyle th {
            background-color: #007bff; /* Blue background for headers */
            color: white; /* White text color for headers */
        }

        .myDataFrameStyle tr:nth-child(even) {
            background-color: #f2f2f2; /* Zebra striping for rows */
        }
        .topic-card {
        background-color: #f8f9fa;  /* Light gray background */
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 10px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);  /* Subtle shadow for depth */
    }

    .topic-header {
        font-size: 18px;
        font-weight: bold;
        color: #343a40;  /* Dark gray for high contrast */
    }

    .topic-word {
        display: inline-block;
        margin-right: 5px;
        margin-bottom: 5px;
        font-weight: normal;  /* Normal weight to reduce emphasis */
        color: #495057;  /* Dark gray */
    }

    .word-weight {
        font-size: smaller;  /* Smaller font size for weights */
        color: #6c757d;  /* Medium gray */
    }

    </style>
</head>
<body>
    <div>
        <button onclick="window.location.href = '/';" style="color: white;">Буцах</button>
    </div>
    <h1 style="align-self: left;">Боловсруулалт</h1>
    <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'text_container')">Текст</button>
        <button class="tablinks" onclick="openTab(event, 'ngram')">Ngram</button>
        <button class="tablinks" onclick="openTab(event, 'Tables')">Өгүүлбэр</button>
        <button class="tablinks" onclick="openTab(event, 'plots')">Үгийн давтамж</button>
        <button class="tablinks" onclick="openTab(event, 'plots2')">Үгийн уртын давтамж</button>
        <button class="tablinks" onclick="openTab(event, 'wordInput')">KWIC</button>
        <button class="tablinks" onclick="openTab(event, 'topic')">topic</button>
        
    </div>
    
    <div id="text_container" class="text-container tabcontent" style="height: 100%;">
        <div class="conta" style="height: 100%;">
            <div class="text-box" id="originalText" style="height: 100%; overflow-y: auto; border: 1px solid #ccc; border-radius: 5px; padding: 10px; width: 40%">
                <h2>Оруулсан текст Үгийн тоо: {{ word_count }}</h2>
                <p>{{ text }}</p>
            </div>
            <div class="text-box" style="height: 100%; overflow-y: auto; border: 1px solid #ccc; border-radius: 5px; padding: 10px; width: 40%">
                <h2>Боловсруулсан текст Үгийн тоо: {{ word_count1 }}</h2>
                <p>{{ text2 }}</p>
            </div>
        </div>
    </div>
    
    <div id="ngram" class="tabcontent">
        <div class="center">
            <label for="select-table">Ngram давтамжийн хүснэгт сонгох:</label>
            <select id="select-table" onchange="showSelectedTable()">
                <option value="1">1 gram</option>
                <option value="2">2 gram</option>
                <option value="3">3 gram</option>
            </select>
        </div>
        <div id="additional-plots">
            <div class="center" id="plot-1">
                <img src="data:image/png;base64,{{ plot_url11 }}" alt="Word Frequency Plot 1.1">
            </div>
            <div class="center hide" id="plot-2">
                <img src="data:image/png;base64,{{ plot_url12 }}" alt="Word Frequency Plot 1.2">
            </div>
            <div class="center hide" id="plot-3">
                <img src="data:image/png;base64,{{ plot_url13 }}" alt="Word Frequency Plot 1.3">
            </div>
        </div>
        <div class="container">
            <div id="result-df-1" class="myDataFrameStyle">{{ result_df1|safe }}</div>
            <div id="result-df-2" class="myDataFrameStyle hide">{{ result_df2|safe }}</div>
            <div id="result-df-3" class="myDataFrameStyle hide">{{ result_df3|safe }}</div>
        </div>
        
    </div>
    <div id="Tables" class="tabcontent">
        <div class="text-container">
            <div class="myDataFrameStyle">
                <h2>1 Өгүүлбэр: {{ height }}</h2>{{df|safe}}
            </div>
        </div>
    </div>
    <div id="plots" class="tabcontent">
        <div class="center">
            <img src="data:image/png;base64,{{ plot_url }}" alt="Word Frequency Plot 1">
        </div>
    </div>
    <div id="plots2" class="tabcontent">
        <div class="center">
            <img src="data:image/png;base64,{{ plot_url1 }}" alt="Word Frequency Plot 1">
        </div>
    </div>
    <div id="plots21" class="tabcontent">
        <div class="center">
            <img src="data:image/png;base64,{{ plot_url }}" alt="Word Frequency Plot 1">
        </div>
    </div>
    <div id="wordInput" class="tabcontent">
        <div class="container mt-5">
            <input type="text" id="textInput" class="form-control" placeholder="Үг оруулна уу...">
            <button onclick="submitData()" class="btn btn-primary mt-3">Хайх</button>
            <div id="dataFrame" class="mt-3" style="width: 900px;"></div>
        </div>
    </div>
    <div id="topic" class="tabcontent">
        <h1>Сэдвүүд</h1>
        {% if topic %}
            <div class="topics-container">
                {% for topica in topic %}
                    <div class="topic-card">
                        <div class="topic-header">Topic {{ topica.topic_id }}:</div>
                        <ul class="topic-words-list">
                            {% for word, weight in topica.words %}
                                <li class="topic-word">
                                    {{ word }} <span class="word-weight">({{ weight }})</span>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No topics found.</p>
        {% endif %}
    </div>
    
    
    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.tablinks').click();
        });
        function showSelectedTable() {
            var selectedTable = document.getElementById("select-table").value;
            var allTables = document.querySelectorAll(".myDataFrameStyle");
            allTables.forEach(function(table) {
                table.classList.add("hide");
            });
            document.getElementById("result-df-" + selectedTable).classList.remove("hide");
    
            // Show corresponding additional plots
            var allPlots = document.querySelectorAll("#additional-plots .center");
            allPlots.forEach(function(plot) {
                plot.classList.add("hide");
            });
            document.getElementById("plot-" + selectedTable).classList.remove("hide");
        }
        function submitData() {
            var textInput = document.getElementById('textInput').value;
            $.ajax({
                url: '/process-data',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({text: textInput}),
                success: function(response) {
                    $('#dataFrame').html(response.html);
                },
                error: function(error) {
                    console.log("Error:", error);
                }
            });
        }

    </script>
    
</body>
</html>
